<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"/>
    <!DOCTYPE html>
    <TITLE>Create xml</TITLE>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<script src="jquery-3.2.1.min.js">
</script>

<div id="navigation" STYLE="background:Lavender; text-align: left; height:120px; width:50%; float: left;">
    <p>&nbsp</p>
    <h1 STYLE="right;font-size:24px;">&#8195;Add xml config </h1>
</div>
<DIV id="navigation"
     STYLE="background:Lavender; text-align: right; height:120px; width:48%; float: right;font-size:18px; padding-right: 2%;">
    <p>&nbsp</p>
    <nav><a href="/">BACK TO PARSER</a></nav>
</DIV>
<p style="position:fixed; top:20%; right:10%;">
    <img src="Exmple.jpg" style="right:10%;">
</p>
<p style="position:fixed; top:65%; right:12%;">
    <img src="Example2.png" style="right:10%;">
</p>

<form id="fromNameToMo">
    <p>&nbsp</p>
    <p>Name of config file
        <br>
        <input type="text" id="nameFile" name="nameFile" value="rxbspTEST" title="Only letter" spellcheck="false" style="width:50%"
               autofocus required placeholder="With out .xml. Only letters and numbers">
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">

        <!--<input type="text" style="min-width:50%" onkeydown="this.style.width = ((this.value.length + 1) * 8) + 'px';"> -->


    </p>
    <p>Header of the printout
        <br>
        <input type="text" name="Header" value="RADIO X-CEIVER ADMINISTRATION BTS STATUS DATA" style="width:50%"
               placeholder="Header for this type printouts">

        <!--<input type="text" style="min-width:50%" onkeydown="this.style.width = ((this.value.length + 1) * 8) + 'px';"> -->


    </p>
    <p>Pattern of regular expression for parsing
        <br>
        <input type="text" name="limiter"
               value="MO\s+OPCOND\s+OPCONDMAP\s+OMLSTAT\s+RSLSTAT \n{2,}"
               style="min-width:50%; max-width:100%;" onkeydown="this.style.width = ((this.value.length) * 8) + 'px';"
               placeholder="Regular expression for parsing. Example: MO FAULT CODES CLASS 2A \n{2,}" required>
    </p>

    <p>Name of managed object
        <br>
        <input type="text" name="name_key" value="MO" title="Letters and "
               placeholder="Managed object. Example {MO NSEI}"
               style="width:50%" required>
    </p>
    <p>Releases for this printout
        <br>
        <input type="text" name="Releases" value="A57" title=""
               placeholder="Available releases :G13B, G14B, A53, A54, A55, A56, A57, A58"
               style="width:50%" required>
    </p>
    <p>Values for parsing
        <br>
        <input type="text" name="keys" value="OPCONDMAP" style="width:50%"
               pattern="([\d\w]+ ?)+[\d\w]$" placeholder="Insert searching keys if format {key1 key2 key3}" required>
    </p>
    </div>

    <script type="text/javascript">

function generate_bit_map(form, keys,name){


name.disabled = true;
var str = keys.value;


var true_str = str.replace(/\s+/g, ' ');

if (true_str.substring(true_str.length-1,true_str.length) == ' '){
    true_str = true_str.slice(0, -1);
}

var arr = true_str.split(" ");
var i = 0;



for (i = 0; i <arr.length; i++){
var node = document.createTextNode(arr[i]);
var para = document.createElement("p");

var node1 = document.createTextNode("System of calculation for in \xa0\xa0 \xa0 \xa0 \xa0");
var node2 = document.createTextNode("System of calculation for out \xa0 \xa0\xa0 \xa0");
var node3 = document.createTextNode("Direction of calculation \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0");
var node4 = document.createTextNode("Key value indicating no error \xa0 \xa0 \xa0");
var para1 = document.createElement("p");
var para2 = document.createElement("p");
var para3 = document.createElement("p");
var para4 = document.createElement("p");

var btndiv = document.createElement("div");
btndiv.id = arr[i];
document.getElementById("myDiv").appendChild(btndiv);

var in_type = document.createElement('input');
in_type.type = 'text';
in_type.value = "16"
in_type.setAttribute("maxlength","4");
in_type.name = 'in_type';

var out_type = document.createElement('input');
out_type.type = 'text';
out_type.value = "2"
out_type.setAttribute("maxlength","4");
out_type.name = 'out_type';

var direct = document.createElement('input');
direct.type = 'text';
direct.value = ""
direct.setAttribute("maxlength","4");
direct.name = 'direct';

var norm_val = document.createElement('input');
norm_val.type = 'text';
norm_val.value = "0"
norm_val.setAttribute("maxlength","4");
norm_val.name = 'norm_val';

var btnbits = document.createElement('input');
btnbits.type = 'button';
btnbits.value = "Add bit to bit-map";
btnbits.name = arr[i];
btnbits.setAttribute("onclick","append(this.form, this.name)");

btndiv.appendChild(btnbits);
para1.appendChild(node);

para.appendChild(node1);
para.appendChild(out_type);

para2.appendChild(node2);
para2.appendChild(in_type);

para3.appendChild(node3);
para3.appendChild(direct);

para4.appendChild(node4);
para4.appendChild(norm_val);

document.getElementById("myDiv").appendChild(para1).appendChild(btndiv).appendChild(para).appendChild(para2).appendChild(para3).appendChild(para4);


}

}






    </script>

    <script type="text/javascript">
function append(form, name) {
    var btndiv = document.createElement("div");
    btndiv.id = 'divBtn';
    document.getElementById(name).appendChild(btndiv);

    var btn = document.createElement('input');
    btn.type = 'text';
    btn.name = name;
    btn.value = "F1 2 MO is degraded or not operational due to internal TRXC fault."
    btn.size = 65;
    btn.setAttribute("placeholder","Insert bit in format {name, value, text}");
    btn.setAttribute("pattern","[a-zA-Z0-9]+ [0-9]{,3} .+");
    btndiv.appendChild(btn);

}

function a(obj) {
if (obj!=undefined) {
obj.disabled=true;
//obj.disabled=(!obj.disabled);
}
}

function onReceive(val){
    console.log("'" + val + "'");
    console.log("'" + "false\n" + "'");

    if (val == 'false\n'){
        myFunction()
    }
    else {
    alert(val)}


}

function send_data(){
    var a = $("#fromNameToMo").serialize();
    console.log(a);
$.post('cgi-bin/add_xml_config.py', a, onReceive)

}

function myFunction() {
    var txt;
    var nameOfFile = prompt("Please enter your name:", "");
     $("#nameFile").val(nameOfFile);
     //console.log(document.getElementById("nameFile"));
    send_data();

}

</script>


    <form id="keys_bits" name="keys_bit" onload="readfile()">
        <table>
            <div id="myDiv">
                <input type="button" name=button1 value="Generate bit-map for keys"
                       onclick="generate_bit_map(this.form, keys, this.name);this.hidden=true;">

            </div>
        </table>
        <p>Additional values for parsing
            <br>
            <input type="text" name="KeysToPrint" style="width:50%" value=""
                   placeholder="By side key that you want to print">
            </br>


             <!--<input type="submit" value="Create xml config" formaction="/cgi-bin/add_xml_config.py" formmethod="post">-->
            <input type="button" value="Create xml config" onclick="send_data()"/>
        </p>

    </form>
</form>
<!--var newWin = window.prompt("sometext","defaultText", "width=200,height=200");-->

<form>

    <p id="demo"></p>
</form>

</body>
</html>